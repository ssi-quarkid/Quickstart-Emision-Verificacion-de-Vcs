"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("base64url")),t=e(require("canonicalize"));function n(){return(n=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}var i={__proto__:null,createJws:function(e,n,i){try{var o=r.encode(t(i))+"."+r.encode(t(n));return Promise.resolve(e.sign(Buffer.from(o))).then((function(e){return o+"."+r.encode(Buffer.from(e))}))}catch(e){return Promise.reject(e)}},verifyJws:function(e,t){try{var n=t.split("."),i=n[2];return Promise.resolve(e.verify(Buffer.from(n[0]+"."+n[1]),r.toBuffer(i)))}catch(e){return Promise.reject(e)}},createDetachedJws:function(e,i,o){try{var c=r.encode(t(n({},o,{b64:!1,crit:["b64"]}))),a=new Uint8Array(Buffer.concat([Buffer.from(c,"utf-8"),Buffer.from(".","utf-8"),i]));return Promise.resolve(e.sign(Buffer.from(a))).then((function(e){var t=r.encode(Buffer.from(e));return c+".."+t}))}catch(e){return Promise.reject(e)}},verifyDetachedJws:function(e,t,n){try{var i=n.split(".."),o=i[1],c=new Uint8Array(Buffer.concat([Buffer.from(i[0],"utf-8"),Buffer.from(".","utf-8"),t]));return Promise.resolve(e.verify(Buffer.from(c),r.toBuffer(o)))}catch(e){return Promise.reject(e)}}},o=require("borc"),c=function(e,r){switch(void 0===r&&(r="application/did+ld+json"),r){case"application/did+json":case"application/did+cbor":return e.toJsonWebKeyPair();case"application/did+ld+json":return e.toKeyPair()}throw new Error("This implementation of did:key does not support: "+r)},a=["application/did+json","application/did+ld+json","application/did+cbor"],u=function(e,r){void 0===r&&(r="application/did+ld+json");try{var t=function(){return n({"@context":["https://www.w3.org/ns/did/v1","https://ns.did.ai/transmute/v1",{"@base":i}],id:i},u)};if(-1===a.indexOf(r))throw new Error("Unsupported DID Document representation. "+r);var i="did:key:"+e.fingerprint(),o=c(e,r),u={verificationMethod:[o]};e.verifier&&(u=n({},u,{authentication:[o.id],assertionMethod:[o.id],capabilityInvocation:[o.id],capabilityDelegation:[o.id]})),e.deriveSecret&&(u=n({},u,{keyAgreement:[o.id]}));var f=function(){if("Ed25519VerificationKey2018"===e.type)return Promise.resolve(e.toX25519KeyPair(!1)).then((function(e){var t=c(e,r);u=n({},u,{verificationMethod:[].concat(u.verificationMethod,[t]),keyAgreement:[t.id]})}))}();return Promise.resolve(f&&f.then?f.then(t):t())}catch(e){return Promise.reject(e)}};exports.Jws=i,exports.getGet=function(e){return function(r){var t=void 0===r?{}:r,n=t.did,i=t.url;try{if(!(n=n||i))throw new TypeError('"did" must be a string.');return Promise.resolve(e(n)).then((function(e){return e.didDocument}))}catch(e){return Promise.reject(e)}}},exports.getResolve=function(e){return function(r,t){void 0===t&&(t={accept:"application/did+ld+json"});try{var n=r.split("#")[0].split("did:key:").pop();return Promise.resolve(e.fromFingerprint({fingerprint:n})).then((function(e){return Promise.resolve(u(e,t.accept)).then((function(e){var r={"@context":"https://w3id.org/did-resolution/v1",didDocument:e,didDocumentMetadata:{"content-type":t.accept},didResolutionMetadata:{}};return"application/did+cbor"===t.accept?o.encode(r):r}))}))}catch(e){return Promise.reject(e)}}},exports.getVerificationMethod=c,exports.keyToDidDoc=u,exports.types={__proto__:null,staticImplements:function(){return function(e){return e}}};
//# sourceMappingURL=did-key-common.cjs.production.min.js.map
